<div xmlns:nevow="http://nevow.com/ns/nevow/0.1"
     xmlns:athena="http://divmod.org/ns/nevow/0.7"
     nevow:render="liveFragment">

  <div class="loading">
    <h1>Loading...</h1>
  </div>

  <div style="position: static" class="widget-container" />

  <div nevow:pattern="last-message" class="last-message">
    This is the last message
  </div>
  <div nevow:pattern="next-message" class="next-message">
    <b class="next">Next:</b> <nevow:slot name="sender" /> - <i><nevow:slot name="subject" /></i>
  </div>

  <div nevow:pattern="accountChooser">
    <div nevow:pattern="accountChoice" class="list-option"
      onclick="Quotient.Mailbox.Controller.get(this).chooseAccount(this); return false"
      ><span class="opt-name"><nevow:slot name="accountName" /></span></div>
    <div nevow:pattern="selectedAccountChoice" class="selected-list-option"
      ><span class="opt-name"><nevow:slot name="accountName" /></span></div>
  </div>

  <div nevow:pattern="tagChooser" class="tag-chooser">
    <div nevow:pattern="tagChoice" class="list-option"
      onclick="Quotient.Mailbox.Controller.get(this).chooseTag(this); return false"
      ><span class="opt-name"><nevow:slot name="tagName" /></span></div>
    <div nevow:pattern="selectedTagChoice" class="selected-list-option"
      ><span class="opt-name"><nevow:slot name="tagName" /></span></div>
  </div>

  <div nevow:pattern="personChooser">
    <div nevow:pattern="personChoice" class="list-option"
      onclick="Quotient.Mailbox.Controller.get(this).choosePerson(this); return false"
      ><span class="opt-name"><nevow:slot name="personName" /></span>
      <span style="display: none" class="person-key"
        ><nevow:slot name="personKey" /></span></div>
    <div nevow:pattern="selectedPersonChoice" class="selected-list-option"
      ><span class="opt-name"><nevow:slot name="personName" /></span>
      <span style="display: none" class="person-key"
        ><nevow:slot name="personKey" /></span></div>
  </div>

  <div nevow:pattern="mailViewChooser">
    <div nevow:pattern="mailViewChoice" class="list-option"
      onclick="Quotient.Mailbox.Controller.get(this).chooseMailView(this); return false"
      ><span class="opt-name"><nevow:slot name="mailViewName" /></span>
      (<span class="count"><nevow:slot name="count" /></span>)</div>
    <div nevow:pattern="selectedMailViewChoice" class="selected-list-option"
      ><span class="opt-name"><nevow:slot name="mailViewName" /></span>
      (<span class="count"><nevow:slot name="count" /></span>)</div>
  </div>

  <div style="display: none; background-color: #FFFFFF" id="add-person-fragment">
    <nevow:invisible nevow:render="addPersonFragment" />
  </div>

  <div nevow:pattern="view-pane" class="view-pane-content">
    <div class="views-collapsible-pane"
      onclick="Quotient.Common.CollapsiblePane.toggle(this, 'views-'); return false">
      <img class="collapse-arrow" src="/Quotient/static/images/views-outline-collapsed.png" />
      <nevow:slot name="name" />
    </div>
    <div class="pane-body" style="position: absolute; top: -1000px; left: -1000px; max-height: 6em; overflow: auto">
      <nevow:slot name="renderer" />
    </div>
  </div>

  <table cellpadding="0" cellspacing="0" nevow:pattern="button" class="button">
    <tr class="button-row">
      <td>
        <img class="corner" src="/Quotient/static/images/button-tl-corner.png" />
      </td>
      <td class="button-top-edge" />
      <td>
        <img class="corner" src="/Quotient/static/images/button-tr-corner.png" />
      </td>
    </tr>
    <tr>
      <td class="button-left-edge" />
      <td class="button-content"><nevow:slot name="content" /></td>
      <td class="button-right-edge" />
    </tr>
    <tr class="button-row">
      <td>
        <img class="corner" src="/Quotient/static/images/button-bl-corner.png" />
      </td>
      <td class="button-bottom-edge" />
      <td>
        <img class="corner" src="/Quotient/static/images/button-br-corner.png" />
      </td>
    </tr>
  </table>

  <table style="height: 100%; width: 100%" cellpadding="0" cellspacing="0" class="content-table">
    <tr valign="bottom">
      <td></td>
      <td>
        <div class="scrolltable-header" style="display: none">
          <div class="view-shortcut-container" style="text-align: center">
            <a class="selected-view-shortcut" href="#"
              onclick="Quotient.Mailbox.Controller.get(this).viewShortcut(this); return false"
              >Inbox</a> |
            <a class="view-shortcut" href="#"
              onclick="Quotient.Mailbox.Controller.get(this).viewShortcut(this); return false"
              >Sent</a> |
            <a class="view-shortcut" href="#"
              onclick="Quotient.Mailbox.Controller.get(this).viewShortcut(this); return false"
              >Spam</a>
          </div>
          <table cellpadding="0" cellspacing="0" style="width: 100%">
            <tr valign="bottom">
              <td style="height: 14px">
                <img class="scrolltable-corner" src="/Quotient/static/images/scrolltable-header-left-edge.png" />
              </td>
              <td style="width: 100%">
                <div class="scrolltable-header-stretcher" />
              </td>
              <td>
                <img class="scrolltable-corner" src="/Quotient/static/images/scrolltable-header-right-edge.png" />
              </td>
            </tr>
          </table>
        </div>
      </td>
      <td style="width: 100%">
        <div class="inbox-container"
          ><table cellpadding="0" cellspacing="0" style="width: 100%"
            ><tr class="complexity-container" valign="bottom" style="line-height: 0px">
              <td>
                <img src="/Quotient/static/images/complexity-selector-3-unselected.png"
                  onmouseover="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onmouseout="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onclick="Quotient.Mailbox.Controller.get(this).setComplexity(3, this, true)"
                  class="complexity-icon" />
              </td>
              <td>
                <img src="/Quotient/static/images/complexity-selector-2-unselected.png"
                  onmouseover="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onmouseout="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onclick="Quotient.Mailbox.Controller.get(this).setComplexity(2, this, true)"
                  class="complexity-icon" />
              </td>
              <td>
                <img src="/Quotient/static/images/complexity-selector-1-selected.png"
                  onmouseover="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onmouseout="Quotient.Mailbox.Controller.get(this).complexityHover(this)"
                  onclick="Quotient.Mailbox.Controller.get(this).setComplexity(1, this, true)"
                  class="selected-complexity-icon" />
              </td>
              <td style="width: 100%">
                <div class="masthead-top-edge">&#160;</div>
              </td>
            </tr>
          </table>
          <div class="masthead-content">
            <img class="masthead-tr" src="/Quotient/static/images/top-right-buttress.png" />
            <div class="rounded-corner-spacer">&#160;</div>
            <div class="content">
              <div class="progress-meter">
                <div class="progress-bar" />
              </div>

              <div class="next-message-preview">
                <nevow:invisible nevow:render="nextMessagePreview" />
              </div>

              <div style="clear: both; height: 1px">&#160;</div>
              <div class="message-actions" style="visibility: hidden">
                <!-- button renderer will place the contents of the tag inside the
                "content" slot of an instance of the "button" template pattern -->
                <span class="archive-button">
                  <nevow:invisible nevow:render="button">
                    <a href="#" onclick="Quotient.Mailbox.Controller.get(this).archiveThis(this); return false">
                      archive
                    </a>
                  </nevow:invisible>
                </span>
                <span class="delete-button">
                  <nevow:invisible nevow:render="button">
                    <a href="#" onclick="Quotient.Mailbox.Controller.get(this).deleteThis(this); return false">
                      delete
                    </a>
                  </nevow:invisible>
                </span>
                <span class="defer-button">
                  <select onchange="Quotient.Mailbox.Controller.get(this).defer(this)" class="defer">
                    <option>Defer</option>
                    <option>1 hour</option>
                    <option>12 hours</option>
                    <option>1 day</option>
                    <option>1 week</option>
                    <option>other...</option>
                  </select>
                </span>
                <nevow:invisible nevow:render="button">
                  <a href="#" onclick="Quotient.Mailbox.Controller.get(this).forwardThis(this); return false">
                    forward
                  </a>
                </nevow:invisible>
                <nevow:invisible nevow:render="button">
                  <a href="#" onclick="Quotient.Mailbox.Controller.get(this).replyToThis(this); return false">
                    reply
                  </a>
                </nevow:invisible>
                <div style="height: 2px; clear: both">&#160;</div>
                <form style="display: none" class="defer-form"
                  onsubmit="Quotient.Mailbox.Controller.get(this).deferThis(); return false">
                  <table>
                    <tr>
                      <td>Days:</td><td><input type="text" name="days" value="0" /></td>
                    </tr>
                    <tr>
                      <td>Hours:</td><td><input type="text" name="hours" value="1" /></td>
                    </tr>
                    <tr>
                      <td>Minutes:</td><td><input type="text" name="minutes" value="0" /></td>
                    </tr>
                    <tr>
                      <td colspan="2" align="right">
                        <input type="submit" value="Cancel"
                          onclick="Quotient.Mailbox.Controller.get(this).hideDeferForm(); return false" />
                        <input type="submit" value="Defer" />
                      </td>
                    </tr>
                  </table>
                </form>
              </div>
            </div>
          </div>
        </div>
      </td>
    </tr>
    <tr valign="top" style="height: 100%">
      <td class="view-pane-cell">
        <div class="view-pane-container" style="display: none">
          <div class="view-pane">
            <img class="view-pane-tl" src="/Quotient/static/images/views-container-tl-corner.png" />
            <div class="view-pane-top-edge">&#160;</div>
            <div class="rounded-corner-spacer">&#160;</div>
            <nevow:invisible nevow:render="viewPane" name="Mail" renderer="mailViewChooser" />
            <nevow:invisible nevow:render="viewPane" name="People" renderer="personChooser" />
            <nevow:invisible nevow:render="viewPane" name="Tags" renderer="tagChooser" />
            <nevow:invisible nevow:render="viewPane" name="Accounts" renderer="accountChooser" />
          </div>
          <img src="/Quotient/static/images/views-container-bl-corner.png" style="position: relative; top: -13px" />
        </div>
      </td>
      <td>
        <div class="scrolltable-container" style="top: -1000px; left: -1000px">
          <div style="position: absolute; z-index: 99; display: none" class="throbber">
            <img src="/Quotient/static/images/throbber.gif" />
          </div>
          <nevow:invisible nevow:render="scroller" />
        </div>
      </td>
      <td style="width: 100%">
        <div class="message-detail">
          <nevow:invisible nevow:render="messageDetail" />
        </div>
      </td>
    </tr>
    <tr valign="top">
      <td></td>
      <td>
        <div class="scrolltable-footer" style="display: none">
          <table cellpadding="0" cellspacing="0" style="width: 100%">
            <tr valign="top">
              <td style="height: 14px">
                <img class="scrolltable-footer-corner" src="/Quotient/static/images/scrolltable-footer-left-edge.png" />
              </td>
              <td style="width: 100%">
                <div class="scrolltable-footer-stretcher" />
              </td>
              <td>
                <img class="scrolltable-footer-corner" src="/Quotient/static/images/scrolltable-footer-right-edge.png" />
              </td>
            </tr>
          </table>
        </div>
      </td>
      <td class="masthead-bottom">
        <div class="masthead-content-bottom">
          <div class="message-actions" style="visibility: hidden; padding-top: 4px">
            <span class="train-spam-button">
              <nevow:invisible nevow:render="button">
                <a href="#"><athena:handler event="onclick" handler="trainSpam" />This Is Spam</a>
              </nevow:invisible>
            </span>
            <span class="train-clean-button" style="display: none">
              <nevow:invisible nevow:render="button">
                <a href="#"><athena:handler event="onclick" handler="trainHam" />Not Spam</a>
              </nevow:invisible>
            </span>
            <div style="float: right; margin-right: 2px">
              Spam: <span class="spam-state" nevow:render="spamState" />
            </div>
            <div style="height: 2px; clear: both">&#160;</div>
          </div>
          <div class="rounded-corner-spacer" style="padding-bottom: 8px">&#160;</div>
          <img class="masthead-bl" src="/Quotient/static/images/bottom-left-buttress.png" />
          <img class="masthead-br" src="/Quotient/static/images/bottom-right-buttress.png" />
        </div>
      </td>
    </tr>
  </table>
</div>
