<html xmlns:nevow="http://nevow.com/ns/nevow/0.1">
  <head>
    <link rel="stylesheet" type="text/css" href="/Mantissa/mantissa.css" />
    <link rel="stylesheet" type="text/css" href="/Quotient/static/quotient.css" />
    <script type="text/javascript">
      var compose = null;
      function getComposeInstance() {
          if(!compose) {
            compose = window.parent.Quotient.Compose.Controller.get(
                          window.parent.Nevow.Athena.NodeByAttribute(
                              window.parent.document.documentElement,
                              "athena:class",
                              "Quotient.Compose.Controller"));
          }
          return compose;
      }

      function notifyParent() {
        getComposeInstance().uploading();
        document.body.style.opacity = .1;
        document.forms.upload.onsubmit = function() { return false };
      }

      function checkForFileData() {
          var fileData = document.getElementById("file-data");
          if(fileData.childNodes.length) {
              getComposeInstance().gotFileData(
                  eval("(" + fileData.firstChild.nodeValue + ")"));
          }
      }
    </script>
  </head>
  <body onload="checkForFileData()">
    <span style="display: none" id="file-data"
      ><nevow:invisible nevow:render="lastFileData" /></span>

    <center>
      <form enctype="multipart/form-data" method="POST" onsubmit="notifyParent();" name="upload">
        <input name="uploaddata" type="file" />
        <input type="submit" name="upload" value="Upload" />
      </form>
    </center>
  </body>
</html>
